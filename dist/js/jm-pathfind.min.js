var jm=jm||{};"undefined"!=typeof module&&module.exports&&(jm=require("jm-core")),function(){jm.pathfind=jm.pathfind||{}}();var jm=jm||{};"undefined"!=typeof module&&module.exports&&(jm=require("jm-core")),function(){jm.pathfind.Path=jm.EventEmitter.extend({_className:"path",ctor:function(t){this._super(),this.length=0,this.points=null,t&&this.attr(t)}})}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){jm.pathfind.PathBezier=jm.pathfind.Path.extend({_className:"pathBezier",_step:125,ctor:function(t){this.step=this._step,this._super(t),this.init()},init:function(){this.points&&(this._bezierPoints=this._initBezier(this.points),this.length=(this.points.length-1)*this.step)},index2Position:function(t,i){if(t>=this.length)return i.x=this.points[this.points.length-1].x,i.y=this.points[this.points.length-1].y,!1;var n=parseInt(t/this.step),e=1-1/this.step*(t%this.step);return i.x=this._bezierX(e,this._bezierPoints[n]),i.y=this._bezierY(e,this._bezierPoints[n]),!0},_initBezier:function(t){var i=t,n=[],e=.6,s=0,r=[],h=i.length;s=h<0?0:h<30?h:30;for(var o=0;o<s;o++){var p=(o+1)%s;o==s-1&&(p=s-1),r[o]={},r[o].x=(i[o].x+i[p].x)/2,r[o].y=(i[o].y+i[p].y)/2}for(var a=[],o=0;o<s;o++){var p=(o+1)%s,u=(o+s-1)%s;o==s-1&&(p=s-1),0==o&&(u=0);var f={};f.x=(r[o].x+r[u].x)/2,f.y=(r[o].y+r[u].y)/2;var x=i[o].x-f.x,m=i[o].y-f.y,y=2*o;a[y]||(a[y]={}),a[y].x=r[u].x+x,a[y].y=r[u].y+m;var d=(a[y].x-i[o].x)*e,j=(a[y].y-i[o].y)*e;a[y].x=i[o].x+d,a[y].y=i[o].y+j;var c=(y+1)%(2*s);a[c]||(a[c]={}),a[c].x=r[o].x+x,a[c].y=r[o].y+m,d=(a[c].x-i[o].x)*e,j=(a[c].y-i[o].y)*e,a[c].x=i[o].x+d,a[c].y=i[o].y+j}var l=s;l=s<=0?0:s<=30?s-1:29;for(var o=0;o<l;o++){var v=[];v[0]=i[o];var y=2*o;v[1]=a[y+1];var c=(y+2)%(2*s);v[2]=a[c];var p=(o+1)%s;o==s-1&&(p=s-1),v[3]=i[p],n.push(v)}return n},_bezierX:function(t,i){var n=i[0].x*t*t*t,e=3*i[1].x*t*t*(1-t),s=3*i[2].x*t*(1-t)*(1-t),r=i[3].x*(1-t)*(1-t)*(1-t);return n+e+s+r},_bezierY:function(t,i){var n=i[0].y*t*t*t,e=3*i[1].y*t*t*(1-t),s=3*i[2].y*t*(1-t)*(1-t),r=i[3].y*(1-t)*(1-t)*(1-t);return n+e+s+r}}),jm.pathfind.pathBezier=function(t){return new jm.pathfind.PathBezier(t)}}();var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-core")),function(){jm.pathfind.PathPoint=jm.pathfind.Path.extend({_className:"pathPoint",ctor:function(t){this._super(t),this.init()},init:function(){this.points&&(this.length=this.points.length)},index2Position:function(t,i){return t>=this.length?(i.x=this.points[this.points.length-1].x,i.y=this.points[this.points.length-1].y,!1):(i.x=this.points[t].x,i.y=this.points[t].y,!0)}}),jm.pathfind.pathPoint=function(t){return new jm.pathfind.PathPoint(t)}}();